{"version":3,"file":"static/webpack/static/development/pages/shopping-cart.js.23ed385f244c69fc2eea.hot-update.js","sources":["webpack:///./node_modules/@babel/runtime-corejs2/core-js/object/get-own-property-descriptors.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray.js","webpack:///./node_modules/core-js/library/fn/object/get-own-property-descriptors.js","webpack:///./node_modules/core-js/library/modules/_own-keys.js","webpack:///./node_modules/core-js/library/modules/es7.object.get-own-property-descriptors.js","webpack:///./src/features/shopping-cart/ShoppingCart.tsx"],"sourcesContent":["module.exports = require(\"core-js/library/fn/object/get-own-property-descriptors\");","import _Array$isArray from \"../../core-js/array/is-array\";\nexport default function _arrayWithoutHoles(arr) {\n  if (_Array$isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","import _Object$defineProperty from \"../../core-js/object/define-property\";\nexport default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    _Object$defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import _Array$from from \"../../core-js/array/from\";\nimport _isIterable from \"../../core-js/is-iterable\";\nexport default function _iterableToArray(iter) {\n  if (_isIterable(Object(iter)) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return _Array$from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","require('../../modules/es7.object.get-own-property-descriptors');\nmodule.exports = require('../../modules/_core').Object.getOwnPropertyDescriptors;\n","// all object keys, includes non-enumerable and symbols\nvar gOPN = require('./_object-gopn');\nvar gOPS = require('./_object-gops');\nvar anObject = require('./_an-object');\nvar Reflect = require('./_global').Reflect;\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = gOPN.f(anObject(it));\n  var getSymbols = gOPS.f;\n  return getSymbols ? keys.concat(getSymbols(it)) : keys;\n};\n","// https://github.com/tc39/proposal-object-getownpropertydescriptors\nvar $export = require('./_export');\nvar ownKeys = require('./_own-keys');\nvar toIObject = require('./_to-iobject');\nvar gOPD = require('./_object-gopd');\nvar createProperty = require('./_create-property');\n\n$export($export.S, 'Object', {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIObject(object);\n    var getDesc = gOPD.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var i = 0;\n    var key, desc;\n    while (keys.length > i) {\n      desc = getDesc(O, key = keys[i++]);\n      if (desc !== undefined) createProperty(result, key, desc);\n    }\n    return result;\n  }\n});\n","import styled from '@emotion/styled'\nimport { ProductCardTall } from '../product/ProductCardTall'\nimport { AmountInput } from '../../component/AmountInput'\nimport { Button, message, Icon, Modal } from 'antd'\nimport { useQuery, useMutation } from '@apollo/react-hooks'\nimport { DELETE_ITEM } from './gql'\nimport { GET_ME } from '../navigation/gql'\nconst { confirm } = Modal\n\nconst Container = styled.div`\n  background-color: white;\n  width: 90%;\n  margin: 2rem auto;\n  padding: 2rem;\n`\n\nconst CartTable = styled.div`\n  display: grid;\n  grid-template-rows: 1fr;\n  background-color: rgb(236, 236, 236);\n  grid-gap: 1px;\n`\n\nconst CartRow = styled.div`\n  display: grid;\n  grid-template-columns: 3fr 1fr 1fr 1fr;\n  grid-gap: 1.5rem;\n  background-color: white;\n`\nconst CartSumRow = styled.div`\n  display: flex;\n  justify-content: space-between;\n  padding: 1rem 2rem;\n  background-color: white;\n`\nconst Product = styled.div`\n  display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: 1fr 3fr;\n  padding: 1rem;\n`\nconst Price = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`\nconst Amount = styled(Price)``\nconst ProductName = styled(Price)``\nconst StyledButton = styled(Button)`\n  background-color: #ff8e0a;\n  font-size: 1rem;\n  padding: 0rem 2rem;\n`\nconst DeleteIcon = styled(Icon)`\n  cursor: pointer;\n  & svg {\n    fill: red;\n  }\n  margin-left: 1rem;\n  font-size: 1.25rem;\n`\n\nexport const ShoppingCart = () => {\n  const { data, loading, error } = useQuery(GET_ME)\n  const [deleteProductItem] = useMutation(DELETE_ITEM, {\n    update(cache, mutationResult) {\n      const { me } = cache.readQuery({ query: GET_ME })\n      const user = me as User\n      const oldShoppingItems = [...user.shoppingCart.productItems]\n      const newShoppingItems = oldShoppingItems.filter(\n        i => i.id !== mutationResult.data.id,\n      )\n      const newUser = { ...user }\n      newUser.shoppingCart.productItems = newShoppingItems\n      cache.writeData(newUser)\n    },\n  })\n  if (loading) return <div>Lodaing...</div>\n  const me = data.me as User\n  const shoppingCart = me.shoppingCart as ShoppingCart\n  const shoppingCartItems = shoppingCart.productItems\n\n  const showDeleteConfirm = async (key: string) => {\n    confirm({\n      title: `Are you sure delete this ${key}?`,\n      content: 'Some descriptions',\n      okText: 'Yes',\n      okType: 'danger',\n      cancelText: 'No',\n      async onOk() {\n        await deleteItem(key)\n      },\n      onCancel() {\n        console.log('Cancel')\n      },\n    })\n  }\n\n  const deleteItem = async (key: string) => {\n    try {\n      await deleteProductItem({ variables: { key } })\n      message.success('รบรายการ สำเร็จ')\n    } catch (error) {\n      message.error('error has occur')\n    }\n  }\n\n  return (\n    <Container>\n      <h2>รถเข็นสินค้า ({shoppingCartItems.length})</h2>\n      <CartTable>\n        <CartRow>\n          <h4>สินค้า</h4>\n          <h4>ราคา</h4>\n          <h4>ปริมาณ</h4>\n          <h4>ราคารวม</h4>\n        </CartRow>\n        {shoppingCartItems.map(item => {\n          const { product, amount } = item\n          return (\n            <CartRow>\n              <Product>\n                <ProductCardTall buyable={false} onlyImage />\n                <ProductName>\n                  {product.name}\n                  <DeleteIcon\n                    onClick={() =>\n                      showDeleteConfirm(`${product.id}${shoppingCart.id}`)\n                    }\n                    type=\"delete\"\n                  />\n                </ProductName>\n              </Product>\n              <Price>\n                {product.salePrice} บาท / {product.unitType}\n              </Price>\n              <Amount>\n                <AmountInput onChange={e => null} amount={amount} />\n              </Amount>\n              <Price>\n                {(+product.salePrice * amount).toLocaleString()} บาท\n              </Price>\n            </CartRow>\n          )\n        })}\n        <div>\n          <CartSumRow>\n            <h2>ราคารวม ({shoppingCartItems.length} รายการ)</h2>\n            <h2>\n              {shoppingCartItems\n                .reduce(\n                  (prv, cur) => prv + cur.amount * +cur.product.salePrice,\n                  0,\n                )\n                .toLocaleString()}{' '}\n              บาท\n            </h2>\n          </CartSumRow>\n          <CartSumRow>\n            <StyledButton>พิมพ์ใบเสนอราคา</StyledButton>\n            <StyledButton>ถัดไป</StyledButton>\n          </CartSumRow>\n        </div>\n      </CartTable>\n    </Container>\n  )\n}\n"],"mappings":"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","sourceRoot":""}