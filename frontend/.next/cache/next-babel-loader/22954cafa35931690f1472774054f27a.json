{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { Button, Icon, message } from 'antd';\nimport styled from '@emotion/styled';\nimport { useState } from 'react';\nimport { AmountInput } from '../../component/AmountInput';\nimport { GET_ME } from '../navigation/gql';\nimport { useQuery, useMutation } from '@apollo/react-hooks';\nimport { ADD_PRODUCT_TO_CART } from './gql';\nconst Container = styled.div`\n  font-size: 16px;\n  & > h4 {\n    margin-bottom: 2rem;\n  }\n`;\nconst AddCartButton = styled(Button)`\n  background-color: #ff8e0a;\n  width: 100%;\n`;\nconst StyledAmountInput = styled(AmountInput)`\n  width: 15rem;\n`;\nexport const ProductInformation = props => {\n  var _me$shoppingCart;\n\n  const {\n    product\n  } = props;\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: amount,\n    1: setAmount\n  } = useState(1);\n  const {\n    data,\n    loading\n  } = useQuery(GET_ME);\n  const me = data === null || data === void 0 ? void 0 : data.me;\n  const [addProductToCard] = useMutation(ADD_PRODUCT_TO_CART);\n  if (loading) return __jsx(\"div\", null, \"Loading ...\");\n  const {\n    name,\n    description,\n    brand,\n    amount: productAmount,\n    unitType\n  } = product;\n  const shid = me === null || me === void 0 ? void 0 : (_me$shoppingCart = me.shoppingCart) === null || _me$shoppingCart === void 0 ? void 0 : _me$shoppingCart.id;\n\n  const addToCart = async () => {\n    setLoading(true);\n\n    try {\n      await addProductToCard({\n        variables: {\n          pid: product.id,\n          amount,\n          shid,\n          key: `${product.id}${shid}`\n        }\n      });\n      message.success(`เพิ่ม ${product.name} สำเร็จ`);\n    } catch (error) {\n      message.error(`${error}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return __jsx(Container, null, __jsx(\"h3\", null, name), __jsx(\"ul\", null, __jsx(\"li\", null, description), __jsx(\"li\", null, brand), __jsx(\"li\", null, productAmount, \" \", unitType)), __jsx(\"p\", null, \"\\u0E08\\u0E31\\u0E14\\u0E2A\\u0E48\\u0E07\\u0E44\\u0E14\\u0E49\\u0E20\\u0E32\\u0E22\\u0E43\\u0E19 1-3 \\u0E27\\u0E31\\u0E19\\u0E17\\u0E33\\u0E01\\u0E32\\u0E23\"), __jsx(\"p\", null, \"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E17\\u0E35\\u0E48\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E32\\u0E23 (\", unitType, \")\"), __jsx(StyledAmountInput, {\n    amount: amount,\n    onChange: setAmount\n  }), __jsx(AddCartButton, {\n    disabled: isLoading,\n    onClick: addToCart\n  }, __jsx(Icon, {\n    type: \"shopping-cart\"\n  }), \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E44\\u0E1B\\u0E22\\u0E31\\u0E07\\u0E23\\u0E16\\u0E40\\u0E02\\u0E47\\u0E19\"));\n};","map":null,"metadata":{},"sourceType":"module"}